{% extends 'UciAdministradorBundle::base.html.twig' %}

{% block header %}
    <header id="head" class="secondary"></header>
    {% endblock %}

{% block body %}
    <!-- container -->
    <div class="container">

        <ol class="breadcrumb">
            <li><a href="{{ path('uci_administrador_homepage') }}">Inicio</a></li>
            <li class="active">Listado de Cuestionarios</li>
        </ol>
        <div class="row">
            <!-- Sidebar -->
            <aside class="col-md-4 sidebar sidebar-left">
                {% include 'UciAdministradorBundle:Menus:mantenimientoCuestionario.html.twig' %}
            </aside>
            <!-- /Sidebar -->
            <!-- Article main content -->
            <article class="col-sm-8 maincontent">
                <header class="page-header">
                    <h1 class="page-title">Filtrar cuestionarios</h1>
                </header>
                <br>
                <form action="{{ path('uci_administrador_registrarcuestionario') }}" method="POST" enctype="multipart/form-data">
                    <div class="row">
                        <div class="cols-xs-12 col-sm-10 col-md-8 col-lg-8">
                            {{ form_row(form.cuestionarioname) }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="cols-xs-12 col-sm-10 col-md-8 col-lg-8">
                            {{ form_row(form.cantidadPreguntas) }}
                        </div>
                    </div>
                    <h3>Parámetros</h3>
                    <div id="libros" data-filter="#filter" data-prototype="
                         {% filter escape %}
                             {{ include('UciAdministradorBundle:VistaCuestionario:prototipoPLibro.html.twig', { 'form': form.libro.vars.prototype }) }}
                         {% endfilter %}">
                    </div>
                    <div id="areas" data-filter="#filter" data-prototype="
                         {% filter escape %}
                             {{ include('UciAdministradorBundle:VistaCuestionario:prototipoPArea.html.twig', { 'form': form.areaConocimiento.vars.prototype }) }}
                         {% endfilter %}">
                    </div>
                    <div id="grupos" data-filter="#filter" data-prototype="
                         {% filter escape %}
                             {{ include('UciAdministradorBundle:VistaCuestionario:prototipoPGrupo.html.twig', { 'form': form.grupoProcesos.vars.prototype }) }}
                         {% endfilter %}">
                    </div>
                    <div id="triangulos" data-filter="#filter" data-prototype="
                         {% filter escape %}
                             {{ include('UciAdministradorBundle:VistaCuestionario:prototipoPTriangulo.html.twig', { 'form': form.trianguloTalento.vars.prototype }) }}
                         {% endfilter %}">
                    </div>
                    <div id="tipospruebas" data-filter="#filter" data-prototype="
                         {% filter escape %}
                             {{ include('UciAdministradorBundle:VistaCuestionario:prototipoPTipoPrueba.html.twig', { 'form': form.tipoPrueba.vars.prototype }) }}
                         {% endfilter %}">
                    </div>
                    <div id="tiposrespuestas" data-filter="#filter" data-prototype="
                         {% filter escape %}
                             {{ include('UciAdministradorBundle:VistaCuestionario:prototipoPTipoRespuesta.html.twig', { 'form': form.tipoRespuesta.vars.prototype }) }}
                         {% endfilter %}">
                    </div>
                    <div id="conjuntos" data-filter="#filter" data-prototype="
                         {% filter escape %}
                             {{ include('UciAdministradorBundle:VistaCuestionario:prototipoPConjunto.html.twig', { 'form': form.parametroConjunto.vars.prototype }) }}
                         {% endfilter %}">
                    </div>
                    <br>
                    <div class="dropdown">
                        <a data-toggle="dropdown" href="#" id="area_link">Añadir parámetro</a>
                        <ul class="dropdown-menu">
                            <li><a href="#" onclick="agregarFormParametro(event, 5);">Libro</a></li>
                            <li><a href="#" onclick="agregarFormParametro(event, 0);">A. Conocimiento</a></li>
                            <li><a href="#" onclick="agregarFormParametro(event, 1);">G. Procesos</a></li>
                            <li><a href="#" onclick="agregarFormParametro(event, 2);">T. Talento</a></li>
                            <li><a href="#" onclick="agregarFormParametro(event, 3);">T. Prueba</a></li>
                            <li><a href="#" onclick="agregarFormParametro(event, 4);">T. Respuesta</a></li>
                            <li><a href="#" onclick="agregarFormParametro(event, 6);">P. Conjunto</a></li>
                        </ul>
                    </div>         
                    <div class="row">
                        <div class="col-lg-8">                     
                        </div>
                        <div class="col-lg-4 text-right">
                            <button class="btn btn-action" id="enviar" type="submit">Generar</button>
                        </div>
                    </div>
                    {{ form_rest(form) }}
                </form>
                <br><br>





            </article>
            <!-- /Article -->
        </div>


        <br><br>
        <div class="row top-space">

            <br><br>




            <br><br>
        </div>

    </div>	<!-- /container -->

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">

        function addParametro(tipo) {
            var collectionHolder;
            switch (tipo) {
                case 0:
                    collectionHolder = $('#areas');
                    break;
                case 1:
                    collectionHolder = $('#grupos');
                    break;
                case 2:
                    collectionHolder = $('#triangulos');
                    break;
                case 3:
                    collectionHolder = $('#tipospruebas');
                    break;
                case 4:
                    collectionHolder = $('#tiposrespuestas');
                    break;
                case 5:
                    collectionHolder = $('#libros');
                    break;
                case 6:
                    collectionHolder = $('#conjuntos');
                    break;
            }
            var prototype = collectionHolder.attr('data-prototype');
            var form = prototype.replace(/__name__/g, collectionHolder.children().length); //importante
            var removeFormA = $('<a href="#" onclick="addTagFormDeleteLink(event, this); "><span class="navigationSpace glyphicon glyphicon-remove" style="color: red; font-size:180%" ></span></a>');
            var newTr = $('<div class="row top-margin"></div>');
            newTr.append(form);
            newTr.append(removeFormA);
            collectionHolder.append(newTr);
            return prototype;
        }

        function addTagFormDeleteLink(e, elemento) {
            e.preventDefault();
            var removeFormA = elemento.parentNode;
            removeFormA.remove();
        }

        function agregarFormParametro(e, tipo) {
            e.preventDefault();
            addParametro(tipo);
            eventoSelectLibro();
        }
        
        function eventoSelectLibro(){
            $("select[id$='libro']").change(function () {
                $(this).closest("form").hide();
            });
        }

        document.ready = function () {

            $('#uci_bundle_basedatosbundle_cuestionario_cuestionarioname').keydown(function (e) {
                if (e.which != '8' && e.which != '46') {
                    str = $(this).val();
                    str = str.replace(/\s/g, '');
                    $(this).val(str);
                }
            });

            $('#uci_bundle_basedatosbundle_cuestionario_cuestionarioname').bind('input', function (e) {
                var $valor = $(this).val();
                $valor = $valor.replace(/\s/g, "");
                $(this).val($valor);
            });

            $('table').footable().on('click', '.row-delete', function (e) {
                e.preventDefault();
            }
            );

            var handleSpeedBump = function (e) {
                e.preventDefault();
                var href = this.getAttribute("data-href");
                var sure = confirm("¿Esta seguro que desea realizar el borrado?\n (Esta operación no es reversible)");
                if (!sure)
                    return;
                document.location = href;
            };
            $("a.speedbump")
                    .click(handleSpeedBump)
                    .bind("contextmenu", handleSpeedBump)
                    .dblclick(handleSpeedBump)
                    .each(function () {
                        var href = this.href;
                        this.setAttribute("data-href", href);
                        this.href = "javascript:void('Navigate to " + href.replace("'", "") + "')";
                    });
        };
    </script>
{% endblock %}


